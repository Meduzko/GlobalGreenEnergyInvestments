define(["jquery"],function(t){"use strict";return{init:function(o,s){this.domId=t("#"+o),this.count=t("#"+o+" .count"),this.amount=t("#"+o+" .amount"),this.totalAmount=t("#"+o+" .totalAmount"),this.investCount=t("#"+o+" #investCount"),this.totalAmountNeeded=parseInt(s.totalAmountNeeded,10),this.totalAmountInvested=parseInt(s.totalAmountInvested,10),this.amountToInvest=parseInt(s.amountToInvest,10),this.interestPaid=parseInt(s.interestPaid,10),this.projectId=s.projectId,this.mesageBox=".message-box",this.setCount(),this.setTotalAmount(),this.calculateTotal(this.investCount),this.getParticipation()},getParticipation:function(){var o=this;t.ajax({method:"GET",url:"/projects/"+this.projectId+"/avaible_participation.json"}).done(function(t){"error"===t.status?o.showMessage(t.messages,"error"):o.setMaxCounts(t.avaible_participation)}).fail(function(t){o.showMessage(t.messages,"error")})},showMessage:function(t,o){this.domId.find(this.mesageBox).html('<div class="'+o+'-msg">'+t+"</div>")},calculateTotal:function(o){var s=parseFloat(t(o).val());"number"==typeof s&&(this.totalAmount.text(Math.abs(parseFloat(this.amountToInvest)*s).toFixed(2)),this.amount.text(Math.abs(parseFloat(this.interestPaid)*s).toFixed(2)),this.setCount(),this.setTotalAmount())},checkValid:function(){return this.count.hasClass("error")?!1:void compSupport.callFunc("#participationsConfirmationPopup","show")},setCount:function(){localStorage.setItem("confirmCount",parseFloat(this.count.val()))},setMaxCounts:function(t){this.count.prop("max",t)},setTotalAmount:function(){localStorage.setItem("confirmTotalAmount",parseFloat(this.totalAmount.text()).toFixed(2))}}});