define(["jquery","jquery.validate"],function(t){"use strict";return{_externalValidatorsCount:0,_validExternalValidatorsCount:0,_submitFormHandler:function(t){t.submit()},_validationPassHandler:function(){compSupport.triggerCompEvent(this.formSelector,"validationPass",[this]),this.submitForm()},_validationFaillHandler:function(){compSupport.triggerCompEvent(this.formSelector,"validationFail",[this])},validatorsList:["required","email","phone","minlength","maxlength","max-digits-value","creditcard","selectcheck","phonenumber","expiration","equalTo","equal-to-text","date-format-usa","exact-match","todays-date-usa","digits","number","postal-code-payment-method-format","require-from-group"],backEndMsg:{},formSelector:"",validator:void 0,getConfiguration:function(a){var i={rules:{},messages:{},groups:{}},r={messages:{}},e=this;return t("#"+a+" :input").each(function(){var a=e.getFieldConfiguration(this),o=e.getBackEndErrorMessages(this,r),s=t(this).attr("name");a&&(i.rules[s]=a.rules,i.messages[s]=a.messages),o&&(e.backEndMsg=o)}),t("#"+a+" *[data-validator-group]").each(function(){var a=t(this).attr("data-validator-group"),r=i.groups[a]||"";i.groups[a]=r+" "+t(this).attr("name")}),i},getFieldConfiguration:function(a){var i=!1;return t.each(this.validatorsList,function(r,e){var o=t(a).attr("data-validator-"+e),s=t(a).attr("data-validator-"+e+"-msg");void 0!==o&&void 0==s&&(s=o,o=!0),void 0!==o&&void 0!==s&&(0==i&&(i={rules:{},messages:{}}),"true"==o&&(o=!0),i.rules[e]=o,i.messages[e]=s)}),i},getBackEndErrorMessages:function(a,i){var r=t(a).attr("data-backend-validator-msg"),e=t(a).attr("name");return r&&(i.messages[e]=r),i},init:function(a,i){var r=this;this.domId=a,this.disambigTrigger=!0,this.formSelector="#"+a;var e=this.getConfiguration(a);i.ignoreHiddenFields===!1&&(e.ignore=[]),e.submitHandler=function(t){0==r._externalValidatorsCount&&r.disambigTrigger===!0&&r._validationPassHandler()},e.invalidHandler=function(t,a){r._validationFaillHandler()},t(this.formSelector).submit(function(t){compSupport.triggerCompEvent(r.formSelector,"formSubmitValidationStart",[r])}),this.validator=t(this.formSelector).validate(e),this.backEndMsg.messages&&this.validator.showErrors(this.backEndMsg.messages),setTimeout(function(){r.checkIfPrefilledAreValid()},100)},checkIfPrefilledAreValid:function(){var a=this;t(a.formSelector).find('input[type="text"], input[type="email"], input[type="password"]').each(function(){t(this).val()&&a.validator.element(t(this))})},submitForm:function(){this._submitFormHandler(this.getForm())},setSubmitFormHandler:function(t){this._submitFormHandler=t},getForm:function(){return document.getElementById(this.domId)},addAsyncValidator:function(a,i){var r=this;0==r._externalValidatorsCount&&t(this.formSelector).submit(function(){r._validExternalValidatorsCount=0}),r._externalValidatorsCount++,t(this.formSelector).submit(function(t){t.preventDefault(),a.call(i,r)})},asyncValidatorPass:function(){this._validExternalValidatorsCount++,this._validExternalValidatorsCount==this._externalValidatorsCount&&this.isValid()&&this._validationPassHandler()},asyncValidatorFail:function(){this._validExternalValidatorsCount=0,this._validationFaillHandler()},showError:function(t,a){var i=[];i[t]=a,this.validator.showErrors(i),this._validationFaillHandler()},clearErrors:function(){this.validator.resetForm(),t(this.formSelector+" :input").removeClass("error valid")},isValid:function(){return t(this.formSelector).valid()}}});